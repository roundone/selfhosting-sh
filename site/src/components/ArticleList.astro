---
interface Article {
  id: string;
  data: {
    title: string;
    description: string;
    date: Date;
    category: string;
    draft: boolean;
  };
}

interface Props {
  articles: Article[];
  collectionPath: string;
}

const { articles, collectionPath } = Astro.props;

const sorted = articles
  .filter((a) => !a.data.draft)
  .sort((a, b) => b.data.date.getTime() - a.data.date.getTime());
---
{sorted.length === 0 ? (
  <p style="color: var(--text-secondary);">No guides published yet. Check back soon.</p>
) : (
  <div class="article-grid">
    {sorted.map((article) => (
      <a href={`${collectionPath}${article.id}/`} class="article-card">
        <h2>{article.data.title}</h2>
        <p>{article.data.description}</p>
        <div class="article-card-meta">
          <span class="article-category">{article.data.category}</span>
          {' '}&middot;{' '}
          <time datetime={article.data.date.toISOString()}>
            {article.data.date.toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' })}
          </time>
        </div>
      </a>
    ))}
  </div>
)}

---
interface Props {
  articles: any[];
  currentId: string;
}

const { articles, currentId } = Astro.props;

const sectionUrlMap: Record<string, string> = {
  apps: "apps",
  comparisons: "compare",
  roundups: "best",
  replace: "replace",
  hardware: "hardware",
  foundations: "foundations",
  troubleshooting: "troubleshooting",
};

const related = articles.filter((a) => a.id !== currentId).slice(0, 5);
---

{
  related.length > 0 && (
    <section class="mt-12 pt-8 border-t border-border">
      <h2 class="text-xl font-[family-name:var(--font-display)] font-bold mb-4">
        Related Articles
      </h2>
      <div class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
        {related.map((article) => {
          const urlSection =
            sectionUrlMap[article.collection] || article.collection;
          return (
            <a
              href={`/${urlSection}/${article.id}/`}
              class="block p-4 rounded-lg bg-surface border border-border hover:border-accent-dim transition-all"
            >
              <h3 class="font-bold text-primary text-sm">
                {article.data.title}
              </h3>
              <p class="mt-1 text-xs text-secondary line-clamp-2">
                {article.data.description}
              </p>
            </a>
          );
        })}
      </div>
    </section>
  )
}
